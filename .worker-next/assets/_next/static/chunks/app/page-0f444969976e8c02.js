(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[931],{6488:function(e,t,s){Promise.resolve().then(s.bind(s,2566))},2566:function(e,t,s){"use strict";let n,r,a,l;s.r(t),s.d(t,{default:function(){return M}});var o=s(7437),i=s(2265);let c=(e,t)=>t.some(t=>e instanceof t),d=new WeakMap,m=new WeakMap,u=new WeakMap,x={get(e,t,s){if(e instanceof IDBTransaction){if("done"===t)return d.get(e);if("store"===t)return s.objectStoreNames[1]?void 0:s.objectStore(s.objectStoreNames[0])}return y(e[t])},set:(e,t,s)=>(e[t]=s,!0),has:(e,t)=>e instanceof IDBTransaction&&("done"===t||"store"===t)||t in e};function y(e){var t;if(e instanceof IDBRequest)return function(e){let t=new Promise((t,s)=>{let n=()=>{e.removeEventListener("success",r),e.removeEventListener("error",a)},r=()=>{t(y(e.result)),n()},a=()=>{s(e.error),n()};e.addEventListener("success",r),e.addEventListener("error",a)});return u.set(t,e),t}(e);if(m.has(e))return m.get(e);let s="function"==typeof(t=e)?(r||(r=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])).includes(t)?function(...e){return t.apply(p(this),e),y(this.request)}:function(...e){return y(t.apply(p(this),e))}:(t instanceof IDBTransaction&&function(e){if(d.has(e))return;let t=new Promise((t,s)=>{let n=()=>{e.removeEventListener("complete",r),e.removeEventListener("error",a),e.removeEventListener("abort",a)},r=()=>{t(),n()},a=()=>{s(e.error||new DOMException("AbortError","AbortError")),n()};e.addEventListener("complete",r),e.addEventListener("error",a),e.addEventListener("abort",a)});d.set(e,t)}(t),c(t,n||(n=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])))?new Proxy(t,x):t;return s!==e&&(m.set(e,s),u.set(s,e)),s}let p=e=>u.get(e),f=["get","getKey","getAll","getAllKeys","count"],h=["put","add","delete","clear"],g=new Map;function b(e,t){if(!(e instanceof IDBDatabase&&!(t in e)&&"string"==typeof t))return;if(g.get(t))return g.get(t);let s=t.replace(/FromIndex$/,""),n=t!==s,r=h.includes(s);if(!(s in(n?IDBIndex:IDBObjectStore).prototype)||!(r||f.includes(s)))return;let a=async function(e,...t){let a=this.transaction(e,r?"readwrite":"readonly"),l=a.store;return n&&(l=l.index(t.shift())),(await Promise.all([l[s](...t),r&&a.done]))[0]};return g.set(t,a),a}x={...a=x,get:(e,t,s)=>b(e,t)||a.get(e,t,s),has:(e,t)=>!!b(e,t)||a.has(e,t)};let v=["continue","continuePrimaryKey","advance"],j={},N=new WeakMap,S=new WeakMap,w={get(e,t){if(!v.includes(t))return e[t];let s=j[t];return s||(s=j[t]=function(...e){N.set(this,S.get(this)[t](...e))}),s}};async function*C(...e){let t=this;if(t instanceof IDBCursor||(t=await t.openCursor(...e)),!t)return;let s=new Proxy(t,w);for(S.set(s,t),u.set(s,p(t));t;)yield s,t=await (N.get(s)||t.continue()),N.delete(s)}function D(e,t){return t===Symbol.asyncIterator&&c(e,[IDBIndex,IDBObjectStore,IDBCursor])||"iterate"===t&&c(e,[IDBIndex,IDBObjectStore])}x={...l=x,get:(e,t,s)=>D(e,t)?C:l.get(e,t,s),has:(e,t)=>D(e,t)||l.has(e,t)};let I="leads",B=null,k=()=>(B||(B=function(e,t,{blocked:s,upgrade:n,blocking:r,terminated:a}={}){let l=indexedDB.open(e,1),o=y(l);return n&&l.addEventListener("upgradeneeded",e=>{n(y(l.result),e.oldVersion,e.newVersion,y(l.transaction),e)}),s&&l.addEventListener("blocked",e=>s(e.oldVersion,e.newVersion,e)),o.then(e=>{a&&e.addEventListener("close",()=>a()),r&&e.addEventListener("versionchange",e=>r(e.oldVersion,e.newVersion,e))}).catch(()=>{}),o}("solar-leads",0,{upgrade(e){e.objectStoreNames.contains(I)||e.createObjectStore(I,{keyPath:"id"})}})),B);function E(e){let{data:t,onUpdate:s}=e;return(0,i.useEffect)(()=>{let e=function(e){let{currentMonthlyBill:t,yearlyInflationRate:s,systemCost:n}=e,r=1+s/100,a=0,l=0,o=[];for(let e=1;e<=25;e++){let s=12*t*Math.pow(r,e-1),i=1===e?n:0;a+=s-i,0===l&&a>0&&(l=e),o.push({year:e,utilityCost:s,solarCost:i,cumulativeSavings:a})}return{twentyFiveYearSavings:a,breakEvenYear:l,yearlyBreakdown:o}}({currentMonthlyBill:t.currentMonthlyBill,yearlyInflationRate:t.yearlyInflationRate,systemCost:t.systemCost,systemSizeKw:t.systemSizeKw});s({twentyFiveYearSavings:e.twentyFiveYearSavings,breakEvenYear:e.breakEvenYear})},[t.currentMonthlyBill,t.yearlyInflationRate,t.systemCost,t.systemSizeKw,s]),(0,o.jsxs)("div",{className:"space-y-4 sm:space-y-6",children:[(0,o.jsxs)("div",{children:[(0,o.jsx)("label",{className:"block text-sm font-medium mb-2",children:"Client Name"}),(0,o.jsx)("input",{type:"text",value:t.clientName,onChange:e=>s({clientName:e.target.value}),className:"w-full px-3 sm:px-4 py-3 sm:py-2 bg-secondary rounded-lg border border-input text-base",placeholder:"John Doe"})]}),(0,o.jsxs)("div",{children:[(0,o.jsx)("label",{className:"block text-sm font-medium mb-2",children:"Address"}),(0,o.jsx)("input",{type:"text",value:t.address,onChange:e=>s({address:e.target.value}),className:"w-full px-3 sm:px-4 py-3 sm:py-2 bg-secondary rounded-lg border border-input text-base",placeholder:"123 Main St"})]}),(0,o.jsxs)("div",{children:[(0,o.jsx)("label",{className:"block text-sm font-medium mb-2",children:"Company Name"}),(0,o.jsx)("input",{type:"text",value:t.companyName,onChange:e=>s({companyName:e.target.value}),className:"w-full px-3 sm:px-4 py-3 sm:py-2 bg-secondary rounded-lg border border-input text-base",placeholder:"Your Solar Company"})]}),(0,o.jsxs)("div",{children:[(0,o.jsxs)("label",{className:"block text-sm font-medium mb-2",children:["Current Monthly Bill: $",t.currentMonthlyBill]}),(0,o.jsx)("input",{type:"range",min:"50",max:"1000",step:"10",value:t.currentMonthlyBill,onChange:e=>s({currentMonthlyBill:Number(e.target.value)}),className:"w-full h-3 sm:h-2 bg-secondary rounded-lg appearance-none cursor-pointer"})]}),(0,o.jsxs)("div",{children:[(0,o.jsxs)("label",{className:"block text-sm font-medium mb-2",children:["Yearly Inflation Rate: ",t.yearlyInflationRate,"%"]}),(0,o.jsx)("input",{type:"range",min:"0",max:"10",step:"0.5",value:t.yearlyInflationRate,onChange:e=>s({yearlyInflationRate:Number(e.target.value)}),className:"w-full h-3 sm:h-2 bg-secondary rounded-lg appearance-none cursor-pointer"})]}),(0,o.jsxs)("div",{children:[(0,o.jsxs)("label",{className:"block text-sm font-medium mb-2",children:["System Size: ",t.systemSizeKw," kW"]}),(0,o.jsx)("input",{type:"range",min:"3",max:"20",step:"0.5",value:t.systemSizeKw,onChange:e=>s({systemSizeKw:Number(e.target.value)}),className:"w-full h-3 sm:h-2 bg-secondary rounded-lg appearance-none cursor-pointer"})]}),(0,o.jsxs)("div",{children:[(0,o.jsxs)("label",{className:"block text-sm font-medium mb-2",children:["System Cost: $",t.systemCost.toLocaleString()]}),(0,o.jsx)("input",{type:"range",min:"5000",max:"50000",step:"1000",value:t.systemCost,onChange:e=>s({systemCost:Number(e.target.value)}),className:"w-full h-3 sm:h-2 bg-secondary rounded-lg appearance-none cursor-pointer"})]})]})}function F(e){let{data:t}=e,s=e=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD",minimumFractionDigits:0,maximumFractionDigits:0}).format(e);return(0,o.jsxs)("div",{className:"bg-card/80 backdrop-blur-sm border rounded-lg p-4 sm:p-6 space-y-4 sm:space-y-6 shadow-lg",children:[(0,o.jsxs)("div",{className:"text-center",children:[(0,o.jsx)("h2",{className:"text-xs sm:text-sm text-muted-foreground mb-2",children:"25-Year Savings"}),(0,o.jsx)("p",{className:"text-3xl sm:text-5xl font-bold text-primary",children:s(t.twentyFiveYearSavings)})]}),(0,o.jsxs)("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-3 sm:gap-4",children:[(0,o.jsxs)("div",{className:"text-center p-3 sm:p-4 bg-secondary rounded-lg",children:[(0,o.jsx)("p",{className:"text-xs sm:text-sm text-muted-foreground mb-1",children:"Break-Even Year"}),(0,o.jsxs)("p",{className:"text-xl sm:text-2xl font-bold",children:["Year ",t.breakEvenYear]})]}),(0,o.jsxs)("div",{className:"text-center p-3 sm:p-4 bg-secondary rounded-lg",children:[(0,o.jsx)("p",{className:"text-xs sm:text-sm text-muted-foreground mb-1",children:"System Cost"}),(0,o.jsx)("p",{className:"text-xl sm:text-2xl font-bold",children:s(t.systemCost)})]})]}),(0,o.jsxs)("div",{className:"space-y-2",children:[(0,o.jsxs)("div",{className:"flex justify-between text-sm",children:[(0,o.jsx)("span",{className:"text-muted-foreground",children:"Utility (25 years)"}),(0,o.jsx)("span",{className:"text-destructive font-medium",children:s(300*t.currentMonthlyBill*1.6327389048734713)})]}),(0,o.jsxs)("div",{className:"flex justify-between text-sm",children:[(0,o.jsx)("span",{className:"text-muted-foreground",children:"Solar (25 years)"}),(0,o.jsx)("span",{className:"text-primary font-medium",children:s(t.systemCost)})]})]}),(0,o.jsxs)("div",{className:"relative h-8 bg-secondary rounded-full overflow-hidden",children:[(0,o.jsx)("div",{className:"absolute left-0 top-0 h-full bg-primary transition-all duration-300",style:{width:"".concat(Math.min(100,t.twentyFiveYearSavings/(2*t.systemCost)*100),"%")}}),(0,o.jsx)("div",{className:"absolute inset-0 flex items-center justify-center text-xs font-medium",children:"Savings Progress"})]})]})}function L(e){let{data:t}=e,[n,r]=(0,i.useState)(!1),a=t.clientName.trim()&&t.address.trim(),l=async()=>{if(a)try{r(!0);let{jsPDF:e}=await Promise.all([s.e(213),s.e(505),s.e(729)]).then(s.bind(s,7501)),n=new e;n.setFontSize(24),n.setTextColor(255,193,7),n.text(t.companyName||"SOLAR PROPOSAL",20,30),n.setFontSize(10),n.setTextColor(100,100,100),n.text("Generated by SolarClose",20,40),n.setFontSize(16),n.setTextColor(0,0,0),n.text("Client Information",20,60),n.setFontSize(12),n.text("Name: ".concat(t.clientName),20,75),n.text("Address: ".concat(t.address),20,85),n.setFillColor(255,248,220),n.rect(20,100,170,30,"F"),n.setFontSize(20),n.setTextColor(255,193,7),n.text("$".concat(t.twentyFiveYearSavings.toLocaleString()),105,120,{align:"center"}),n.setFontSize(10),n.setTextColor(100,100,100),n.text("Total 25-Year Savings",105,127,{align:"center"}),n.setFontSize(16),n.setTextColor(0,0,0),n.text("System Details",20,150),n.setFontSize(12),n.text("System Size: ".concat(t.systemSizeKw," kW"),20,165),n.text("System Cost: $".concat(t.systemCost.toLocaleString()),20,175),n.text("Current Monthly Bill: $".concat(t.currentMonthlyBill),20,185),n.text("Break-Even Year: Year ".concat(t.breakEvenYear),20,195),n.setFontSize(8),n.setTextColor(150,150,150),n.text("Generated on ".concat(new Date().toLocaleDateString()," | SolarClose ROI Calculator"),105,280,{align:"center"}),n.save("solar-proposal-".concat(t.clientName,".pdf"))}catch(e){console.error("Failed to generate PDF:",e)}finally{r(!1)}};return(0,o.jsx)("button",{onClick:l,disabled:n||!a,className:"w-full bg-primary text-primary-foreground font-semibold py-4 sm:py-3 px-4 sm:px-6 rounded-lg hover:opacity-90 transition-opacity disabled:opacity-50 text-base sm:text-sm",title:a?"":"Please enter client name and address first",children:n?"Generating...":a?"\uD83D\uDCC4 Export Proposal":"\uD83D\uDCC4 Export Proposal (Enter client info)"})}function M(){let{data:e,setData:t,saveStatus:s}=function(e){let[t,s]=(0,i.useState)(null),[n,r]=(0,i.useState)("idle");(0,i.useEffect)(()=>{(async()=>{try{let t=await k(),n=await t.get(I,e);if(n)s(n);else{let t={id:e,createdAt:Date.now(),clientName:"",address:"",companyName:"",currentMonthlyBill:250,yearlyInflationRate:4,systemSizeKw:8.5,systemCost:25e3,twentyFiveYearSavings:0,breakEvenYear:0,isSynced:!1};s(t)}}catch(e){console.error("Failed to load lead:",e),r("error")}})()},[e]);let a=(0,i.useCallback)(async e=>{try{r("saving");let t=await k();await t.put(I,e),r("saved"),setTimeout(()=>r("idle"),1e3)}catch(e){console.error("Failed to save lead:",e),r("error")}},[]),l=(0,i.useRef)(),o=(0,i.useCallback)((e,t)=>()=>{clearTimeout(l.current),l.current=setTimeout(e,t)},[]);return{data:t,setData:(0,i.useCallback)(e=>{s(t=>{if(!t)return null;let s={...t,...e};return o(()=>a(s),500)(),s})},[a,o]),saveStatus:n}}("default-lead");return e?(0,o.jsx)("main",{className:"min-h-screen p-2 sm:p-4",children:(0,o.jsxs)("div",{className:"max-w-4xl mx-auto",children:[(0,o.jsxs)("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between mb-6 sm:mb-8",children:[(0,o.jsx)("h1",{className:"text-2xl sm:text-4xl font-bold text-primary mb-2 sm:mb-0",children:"SolarClose"}),(0,o.jsxs)("div",{className:"text-xs sm:text-sm text-muted-foreground",children:["saving"===s&&"\uD83D\uDCBE Saving...","saved"===s&&"✓ Saved","error"===s&&"⚠ Error"]})]}),(0,o.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-4 sm:gap-6",children:[(0,o.jsxs)("div",{className:"bg-card/80 backdrop-blur-sm border rounded-lg p-4 sm:p-6 shadow-lg",children:[(0,o.jsx)("h2",{className:"text-lg sm:text-xl font-semibold mb-4",children:"Calculator"}),(0,o.jsx)(E,{data:e,onUpdate:t})]}),(0,o.jsxs)("div",{className:"space-y-4 sm:space-y-6",children:[(0,o.jsx)(F,{data:e}),(0,o.jsx)(L,{data:e})]})]})]})}):(0,o.jsx)("main",{className:"min-h-screen bg-background flex items-center justify-center",children:(0,o.jsx)("p",{className:"text-muted-foreground",children:"Loading..."})})}}},function(e){e.O(0,[971,275,744],function(){return e(e.s=6488)}),_N_E=e.O()}]);